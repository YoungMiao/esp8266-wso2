<!DOCTYPE html>
<html style="width:100%;height:100%;">
	<head>
		<meta charset="UTF-8">  
		<title>This is a exercise html.</title>
		<script type="text/javascript" src="qwebchannel.js"></script>
	</head>
	<body style="width:100%;height:100%">
		<!--<div id="buttongroup" style="margin-bottom:2px;">
			<input type="button" value="Read from Json" onclick="readfromjson()" ></input>
		</div>-->
		<div id="container" style="width:100%;height:100%;" ></div>
		<script type="text/javascript" src="jquery-3.2.1.js" ></script>
		<script type="text/javascript" src="echarts.js" ></script>
		<script type="text/javascript">
			if(qt){
				new QWebChannel(qt.webChannelTransport, function(channel) {
					window.bridge = channel.objects.bridge;
				});
			}
			var container = document.getElementById("container");
			var myChart = echarts.init(container);
			var setenvdata2echarts = function(data){
				var tmpOption = myChart.getOption();
				tmpOption.xAxis[0].data = new Array;
				tmpOption.series[0].data = new Array;
				for(var index in data)
				{
					var objdata = data[index];
					tmpOption.xAxis[0].data[index] = objdata.timestamp;
					tmpOption.series[0].data[index] = objdata.value;
				}
				var datalength = data.length;
				for(var index in tmpOption.dataZoom)
				{
					var startlength = (datalength-6)*100.0 / datalength;
					tmpOption.dataZoom[index].start = startlength;
				}
				myChart.setOption(tmpOption);
			}

			var option = {
				toolbox: {
					show : true,
					feature : {
						magicType : {show: true, type: 'line'},
					}
				},
				grid: {
					left: '5%',
					top: '10%',
					right: '5%',
					bottom: 50
				},
				tooltip: {
					trigger: 'axis',
					axisPointer: {			//设置鼠标位置十字显示
						type: 'cross',
						label: {
							textStyle: {
								color: '#fff'
							},
							backgroundColor: '#000'
						}
					},
					backgroundColor: 'rgba(245, 245, 245, 0.8)',
					borderWidth: 1,
					borderColor: '#ccc',
					padding: 10,
					textStyle: {
						color: '#000'
					},
					extraCssText: 'width: 170px'
				},
				xAxis : [{
					type:'category',
					axisLine : {
						lineStyle: {
						
						}
					}
				}],
				yAxis : [{
					type:'value',
					axisLine: {
						lineStyle: {
						
						}
					}
				}],
				dataZoom : [{
					type : 'slider',			//slider类型的缩放，相当于滚动条
					xAxisIndex : [0],
					start : 0,
					end: 100,
					height: 10,
					bottom: '5%'
				},{
					type : 'inside',			//inside类型的缩放，相当于内部拖动和缩放等
					xAxisIndex : [0],
					start : 0,
					end: 100
				}],
				series : [{
					/*name : '温度',*/
					type : 'line',
					markLine : {
						silent : true,
						data : [{type:'average',name:'平均值'}] 
					},
					itemStyle : {
						normal: {
							color: '#c23531'
						}
					}
				}]
			};
			if(myChart && myChart != null)
			{
				myChart.setOption(option);
			}
			var setSerialName = function(name){
				var tmpOption = myChart.getOption();
				tmpOption.series[0].name = name;
				myChart.setOption(tmpOption);
			}
			window.onresize = myChart.resize;
			myChart.on("click",function(params){
				bridge.slotShowMsgFromClick(params.name,params.data,params.seriesName);
			});
			var showOrHideSeries = function(name,isHide)
			{
				var tmpOption = myChart.getOption();
				if(isHide == 1)
				{
					tmpOption.legend[0].selected[name] = true;
				}
				else if(isHide == 0)
				{
					tmpOption.legend[0].selected[name] = false;
				}
				myChart.setOption(tmpOption);
			}
			function setlegendcolor(legendname,clr){
				var tmpOption = myChart.getOption();
				var optionseries = tmpOption.series;
				
				for(var index in optionseries)
				{
					if(optionseries[index].name == legendname)
					{
						optionseries[index].itemStyle.normal.color = clr;
						break;
					}
				}
				myChart.setOption(tmpOption);
			}
			function setAxisTextColor(clr)
			{
				var tmpOption = myChart.getOption();
				var xAxis = tmpOption.xAxis[0];
				var yAxis = tmpOption.yAxis[0];
				xAxis.axisLine.lineStyle.color = clr;
				yAxis.axisLine.lineStyle.color = clr;
				myChart.setOption(tmpOption);
			}
			function setHTMLbackground(clr)
			{
				var htmlbody = document.getElementsByTagName('body');
				htmlbody[0].setAttribute("style","width:100%;height:100%;background-color:"+clr);
			}
			document.documentElement.style.overflow = 'hidden';
		</script>
	</body>
</html>